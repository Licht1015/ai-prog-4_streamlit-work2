# 国会議事録検索・分析アプリケーション

## 📋 プロジェクト概要

### 課題2: Streamlitを使ったアプリの開発 + 公開
**学籍番号**: [学籍番号]  
**作成者**: [名前]  
**作成日**: 2024年8月  
**締切**: 08月15日（金） 23:59

このアプリケーションは、国会議事録APIを活用した高度な検索・分析ツールです。Streamlitを使用して構築され、議事録の検索、分析、可視化機能を提供します。

### 🎯 課題要件の達成状況

#### ✅ 必須要件
- [x] **APIキー/トークン不要のAPI使用**: 国会議事録API（公開API）
- [x] **ユーザー入力の受付**: キーワード、期間、発言者などの検索条件
- [x] **処理と結果表示**: 検索結果の分析・可視化
- [x] **ファイル分離**: アプリ部分（main.py）とロジック部分（logic.py）の分離
- [x] **システム設計図**: 下記に記載
- [x] **コード説明図**: 下記に記載
- [x] **README.md**: アプリ説明と使用APIの記載

#### ✅ 加点要件（+3点）
- [x] **データベース機能**: CSVファイル（search_history.csv）による検索履歴保存

## 🏗️ システム設計図

```
┌─────────────────────────────────────────────────────────────┐
│                    Streamlit Web UI                        │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │   検索機能   │  │   分析機能   │  │   履歴機能   │      │
│  │   (main.py) │  │ (logic.py)  │  │(components) │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
├─────────────────────────────────────────────────────────────┤
│                    Data Processing                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │   Pandas    │  │   Plotly    │  │   Janome    │      │
│  │  DataFrame  │  │  Charts     │  │  Tokenizer  │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
├─────────────────────────────────────────────────────────────┤
│                    External APIs                           │
│  ┌─────────────────────────────────────────────────────┐   │
│  │          国会議事録API                              │   │
│  │      https://kokkai.ndl.go.jp/api/speech          │   │
│  │      (APIキー不要の公開API)                        │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                    Data Storage                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │   CSV File  │  │ Session     │  │   History   │      │
│  │(search_hist)│  │  State      │  │  Management │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
└─────────────────────────────────────────────────────────────┘
```

## 📁 コード説明図

```
work2/
├── main.py                    # アプリケーションエントリーポイント
│   ├── アプリケーション初期化
│   ├── ページルーティング
│   ├── セッション状態管理
│   └── 条件付きインポート処理
│
├── logic.py                   # ビジネスロジック（1198行）
│   ├── KokkaiSearchApp クラス
│   │   ├── __init__()        # 初期化
│   │   ├── search_speeches() # API通信
│   │   ├── extract_keywords() # キーワード抽出
│   │   ├── analyze_results()  # 結果分析
│   │   ├── create_visualizations() # 可視化
│   │   ├── search_page()      # 検索ページ
│   │   ├── analysis_page()    # 分析ページ
│   │   ├── meeting_analysis_page() # キーワード分析
│   │   ├── history_page()     # 履歴ページ
│   │   └── help_page()        # ヘルプページ
│   └── データ処理・分析機能
│
├── components.py              # UIコンポーネント（157行）
│   └── show_sidebar()         # サイドバー表示
│
├── requirements.txt           # 依存関係定義（134行）
├── search_history.csv         # 検索履歴データ
├── README.md                 # プロジェクトドキュメント
└── TECHNICAL_SPECIFICATION.md # 技術仕様書
```

### 技術スタック
- **フレームワーク**: Streamlit
- **データ処理**: Pandas, NumPy
- **可視化**: Plotly, Matplotlib
- **形態素解析**: Janome（日本語）
- **ワードクラウド**: WordCloud
- **API**: 国会議事録API

## 🚀 機能一覧

### 1. 🔍 検索機能
- **高度な検索**: キーワード、期間、会議種別による絞り込み
- **リアルタイム検索**: 検索結果の即座表示
- **検索履歴**: 過去の検索条件の保存・再利用
- **結果エクスポート**: CSV形式での検索結果出力

### 2. 📊 分析機能
- **統計分析**: 発言者別、会議別の統計情報
- **時系列分析**: 期間別の発言頻度分析
- **キーワード分析**: 頻出語句の抽出・分析
- **可視化**: グラフ・チャートによる結果表示

### 3. 🏛️ 会議別キーワード分析
- **形態素解析**: Janomeによる日本語テキスト解析
- **キーワード抽出**: 重要語句の自動抽出
- **ワードクラウド**: 視覚的なキーワード表示
- **ストップワード**: 不要語句の自動除外

### 4. 📚 検索履歴管理
- **履歴保存**: 検索条件と結果数の記録
- **履歴表示**: 過去の検索履歴の一覧表示
- **履歴削除**: 不要な履歴の削除機能
- **CSV出力**: 履歴データの外部出力

## 🛠️ セットアップ手順

### 1. 環境準備（Anaconda仮想環境）
```bash
# Anaconda環境の確認
conda --version

# 新しい仮想環境の作成
conda create -n streamlit

# 環境のアクティベート
conda activate streamlit
```

### 2. 依存関係のインストール
```bash
pip install -r requirements.txt
```

### 3. アプリケーション起動
```bash
streamlit run main.py
```

## 📖 使用方法

### 検索機能の利用
1. **基本検索**: キーワードを入力して検索
2. **詳細検索**: 期間、会議種別、発言者を指定
3. **結果確認**: 検索結果の一覧表示
4. **詳細表示**: 個別の発言内容の確認

### 分析機能の利用
1. **統計表示**: 検索結果の統計情報確認
2. **グラフ表示**: 各種チャート・グラフの確認
3. **エクスポート**: 分析結果のCSV出力

### キーワード分析の利用
1. **会議選択**: 分析対象の会議を選択
2. **キーワード抽出**: 自動的な重要語句抽出
3. **ワードクラウド**: 視覚的なキーワード表示

## 🔧 設定・カスタマイズ

### 環境変数
```python
# API設定
API_URL = "https://kokkai.ndl.go.jp/api/speech"

# 検索履歴設定
HISTORY_FILE = "search_history.csv"
```

### ストップワードのカスタマイズ
```python
# logic.py内のstop_wordsを編集
self.stop_words = {
    'する', 'ある', 'いる', 'なる', 'れる',
    # カスタムストップワードを追加
}
```

## 📊 データ構造

### 検索履歴データ
```csv
timestamp,params,results_count
2024-01-01 10:00:00,"{'keyword': '経済'}",150
```

### 検索結果データ
```json
{
  "speechID": "会議録ID",
  "speech": "発言内容",
  "speaker": "発言者",
  "meeting": "会議名",
  "date": "日付"
}
```

## 🐛 トラブルシューティング

### よくある問題

#### 1. Janomeライブラリのエラー
```
解決方法: pip install janome
```

#### 2. WordCloudライブラリのエラー
```
解決方法: pip install wordcloud matplotlib
```

#### 3. 検索結果が表示されない
- ネットワーク接続を確認
- APIエンドポイントの確認
- 検索条件の見直し

#### 4. グラフが表示されない
- Plotlyライブラリの確認
- データ形式の確認

## 🔄 更新履歴

### v1.0.0 (2024-08-01)
- 初期バージョンリリース
- 基本検索機能
- 分析機能
- 検索履歴機能

### v1.1.0 (2024-08-15)
- キーワード分析機能追加
- ワードクラウド機能追加
- UI改善
- 課題2要件の完全対応

## 📝 開発者向け情報

### コード規約
- **命名規則**: スネークケース（Python標準）
- **コメント**: 日本語での詳細コメント
- **エラーハンドリング**: try-except文の適切な使用

### テスト
```bash
# 単体テストの実行
python -m pytest tests/

# 統合テストの実行
python -m pytest tests/integration/
```

### デプロイ
```bash
# Streamlit Cloud用の設定
# requirements.txtの確認
# .streamlit/config.tomlの設定
```


---

**注意**: このアプリケーションは国会議事録APIを使用しています。APIの利用規約を遵守してご利用ください。

## 📋 課題提出情報

### 提出要件
- [ ] **アプリURL**: [Streamlit Cloud URL]
- [ ] **GitHub URL**: [GitHubレポジトリURL]
- [x] **加点の有無**: 有り（CSVファイルによるデータベース機能）
- [ ] **その他コメント**: [難しかった点や感想など]

### 使用API
**国会議事録API**
- エンドポイント: https://kokkai.ndl.go.jp/api/speech
- APIキー: 不要（公開API）
- 機能: 国会議事録の検索・取得
- レスポンス形式: JSON
