# 国会議事録検索・分析アプリケーション - 技術仕様書

## 📋 プロジェクト概要

### プロジェクト名
国会議事録検索・分析アプリケーション

### 課題2: Streamlitを使ったアプリの開発 + 公開
**学籍番号**: [学籍番号]  
**作成者**: [名前]  
**作成日**: 2024年8月  
**締切**: 08月15日（金） 23:59

### バージョン
1.1.0

### 開発環境
- **Anaconda仮想環境**: Python 3.8+
- **IDE**: 任意のPython対応IDE
- **デプロイ先**: Streamlit Cloud
- **バージョン管理**: Git/GitHub

## 🏗️ システムアーキテクチャ

### 全体構成
```
┌─────────────────────────────────────────────────────────────┐
│                    Streamlit Web UI                        │
├─────────────────────────────────────────────────────────────┤
│                    Business Logic                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │   Search    │  │  Analytics  │  │   History   │      │
│  │   Module    │  │   Module    │  │   Module    │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
├─────────────────────────────────────────────────────────────┤
│                    Data Processing                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │   Pandas    │  │   Plotly    │  │   Janome    │      │
│  │  DataFrame  │  │  Charts     │  │  Tokenizer  │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
├─────────────────────────────────────────────────────────────┤
│                    External APIs                           │
│  ┌─────────────────────────────────────────────────────┐   │
│  │          国会議事録API                              │   │
│  │      https://kokkai.ndl.go.jp/api/speech          │   │
│  │      (APIキー不要の公開API)                        │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### 技術スタック詳細

#### フロントエンド
- **Streamlit**: Webアプリケーションフレームワーク
- **HTML/CSS**: カスタムスタイリング
- **JavaScript**: Plotlyインタラクティブチャート

#### バックエンド
- **Python 3.8+**: メイン言語
- **Requests**: HTTP通信ライブラリ
- **Pandas**: データ処理・分析
- **NumPy**: 数値計算

#### データ可視化
- **Plotly**: インタラクティブチャート
- **Matplotlib**: 静的グラフ（オプション）
- **WordCloud**: ワードクラウド生成（オプション）

#### 自然言語処理
- **Janome**: 日本語形態素解析（オプション）
- **正規表現**: テキスト処理

#### データストレージ
- **CSV**: 検索履歴保存（データベース機能）
- **Session State**: 一時データ保存

## 📁 ファイル構造詳細

### メインファイル
```
work2/
├── main.py                    # アプリケーションエントリーポイント
├── logic.py                   # ビジネスロジック（1198行）
├── components.py              # UIコンポーネント（157行）
├── requirements.txt           # 依存関係定義（134行）
├── search_history.csv         # 検索履歴データ
├── README.md                 # プロジェクトドキュメント
└── TECHNICAL_SPECIFICATION.md # 技術仕様書
```

### ファイル詳細仕様

#### main.py
- **役割**: アプリケーションのエントリーポイント
- **行数**: 313行
- **主要機能**:
  - アプリケーション初期化
  - ページルーティング
  - セッション状態管理
  - 条件付きインポート処理

#### logic.py
- **役割**: ビジネスロジックの実装
- **行数**: 1198行
- **主要クラス**: `KokkaiSearchApp`
- **主要機能**:
  - API通信
  - データ処理
  - 分析機能
  - 可視化機能

#### components.py
- **役割**: UIコンポーネントの定義
- **行数**: 157行
- **主要機能**:
  - サイドバー表示
  - ページ選択
  - セッション状態管理

## 🔧 技術仕様詳細

### API仕様

#### 国会議事録API
```yaml
エンドポイント: https://kokkai.ndl.go.jp/api/speech
メソッド: GET
レスポンス形式: JSON
エンコーディング: UTF-8
APIキー: 不要（公開API）

パラメータ:
  keyword: 検索キーワード（文字列）
  from: 開始日（YYYY-MM-DD形式）
  until: 終了日（YYYY-MM-DD形式）
  speaker: 発言者名（文字列）
  meeting: 会議名（文字列）
  maximumRecords: 最大取得件数（数値）

レスポンス構造:
  {
    "numberOfRecords": 総件数,
    "speechRecord": [
      {
        "speechID": "会議録ID",
        "speech": "発言内容",
        "speaker": "発言者",
        "meeting": "会議名",
        "date": "日付"
      }
    ]
  }
```

### データ構造

#### 検索履歴データ（CSV）
```csv
timestamp,params,results_count
2024-01-01 10:00:00,"{'keyword': '経済', 'from': '2024-01-01'}",150
```

#### 検索結果データ
```json
{
  "speechID": "会議録ID",
  "speech": "発言内容",
  "speaker": "発言者",
  "meeting": "会議名",
  "date": "日付"
}
```

#### 分析データ
```json
{
  "total_records": 総件数,
  "speaker_stats": {
    "発言者名": 発言回数
  },
  "meeting_stats": {
    "会議名": 発言回数
  },
  "date_stats": {
    "日付": 発言回数
  }
}
```

### セッション状態管理

#### 主要セッション変数
```python
st.session_state = {
    'search_history': [],      # 検索履歴
    'search_results': None,    # 検索結果
    'analytics_data': {},      # 分析データ
    'current_page': '🔍 検索'  # 現在のページ
}
```

### エラーハンドリング

#### エラー種別
1. **API通信エラー**
   - ネットワーク接続エラー
   - APIレスポンスエラー
   - タイムアウトエラー

2. **データ処理エラー**
   - JSON解析エラー
   - CSV読み書きエラー
   - データ型変換エラー

3. **ライブラリ依存エラー**
   - Janome未インストール
   - WordCloud未インストール
   - Matplotlib未インストール

#### エラー処理方針
- **グレースフルデグラデーション**: オプション機能の無効化
- **ユーザーフレンドリーなメッセージ**: 分かりやすいエラー表示
- **ログ記録**: デバッグ情報の保存

## 🚀 パフォーマンス仕様

### レスポンス時間
- **検索実行**: 5秒以内
- **ページ表示**: 2秒以内
- **グラフ生成**: 3秒以内

### メモリ使用量
- **最小**: 128MB
- **推奨**: 512MB
- **最大**: 1GB

### 同時接続数
- **開発環境**: 1ユーザー
- **本番環境**: 10ユーザー（推奨）

## 🔒 セキュリティ仕様

### データ保護
- **個人情報**: 収集・保存なし
- **API認証**: 不要（公開API）
- **データ暗号化**: 不要

### アクセス制御
- **認証**: 不要
- **認可**: 不要
- **セッション管理**: Streamlit標準

## 📊 監視・ログ仕様

### ログレベル
- **DEBUG**: 開発時の詳細情報
- **INFO**: 一般的な操作情報
- **WARNING**: 警告情報
- **ERROR**: エラー情報

### 監視項目
- **アプリケーション稼働状況**
- **API通信状況**
- **エラー発生状況**
- **パフォーマンス指標**

## 🔄 デプロイメント仕様

### 開発環境（Anaconda）
```bash
# 環境構築
conda create -n streamlit
conda activate streamlit
pip install -r requirements.txt

# アプリケーション起動
streamlit run main.py
```

### 本番環境（Streamlit Cloud）
```bash
# Streamlit Cloud用の設定
# requirements.txtの確認
# .streamlit/config.tomlの設定
```

### 依存関係
```txt
streamlit>=1.28.0
requests>=2.31.0
pandas>=2.0.0
plotly>=5.15.0
janome>=0.5.0 (オプション)
wordcloud>=1.9.0 (オプション)
matplotlib>=3.7.0 (オプション)
```

## 📈 拡張性・保守性

### 拡張ポイント
1. **新しい分析機能の追加**
2. **追加の可視化オプション**
3. **外部APIとの連携**
4. **データベース連携**

### 保守性
- **モジュラー設計**: 機能別の分離
- **詳細コメント**: 日本語での説明
- **エラーハンドリング**: 包括的な処理
- **設定外部化**: 環境変数での管理

## 🧪 テスト仕様

### 単体テスト
- **API通信テスト**
- **データ処理テスト**
- **UIコンポーネントテスト**

### 統合テスト
- **エンドツーエンドテスト**
- **パフォーマンステスト**
- **ブラウザ互換性テスト**

### テスト環境
```bash
# テスト実行
python -m pytest tests/
python -m pytest tests/integration/
```

## 📋 課題要件対応状況

### ✅ 必須要件
- [x] **APIキー/トークン不要のAPI**: 国会議事録API（公開API）
- [x] **ユーザー入力の受付**: キーワード、期間、発言者などの検索条件
- [x] **処理と結果表示**: 検索結果の分析・可視化
- [x] **ファイル分離**: main.py（アプリ）とlogic.py（ロジック）の分離
- [x] **システム設計図**: 上記に記載
- [x] **コード説明図**: 上記に記載
- [x] **README.md**: アプリ説明と使用APIの記載

### ✅ 加点要件（+3点）
- [x] **データベース機能**: CSVファイル（search_history.csv）による検索履歴保存

---

**注意**: この技術仕様書は課題2の提出用として作成されており、一人開発による国会議事録検索・分析アプリケーションの技術仕様を記載しています。 